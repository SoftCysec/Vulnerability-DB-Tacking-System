from django.db import models

class Vulnerability(models.Model):
    SEVERITY_CHOICES = (
        ('Low', 'Low'),
        ('Medium', 'Medium'),
        ('High', 'High'),
        ('Critical', 'Critical'),
    )

    name = models.CharField(max_length=100, unique=True, help_text="Name or title of the vulnerability.")
    description = models.TextField(help_text="Detailed description of the vulnerability.")
    severity = models.CharField(max_length=100, choices=SEVERITY_CHOICES, default='Low', help_text="Severity level of the vulnerability.")
    cve = models.CharField(max_length=100, help_text="Common Vulnerabilities and Exposures (CVE) identifier.")
    cwe = models.CharField(max_length=100, help_text="Common Weakness Enumeration (CWE) identifier.")
    owasp = models.CharField(max_length=100, help_text="OWASP reference.")
    wasc = models.CharField(max_length=100, help_text="Web Application Security Consortium (WASC) identifier.")
    url = models.CharField(max_length=100, help_text="Reference URL for the vulnerability.")
    solution = models.TextField(help_text="Proposed solution or remediation for the vulnerability.")
    date = models.DateTimeField(auto_now_add=True, help_text="Date and time when the vulnerability was added to the system.")

    def __str__(self):
        return self.name

    class Meta:
        ordering = ['-date']
